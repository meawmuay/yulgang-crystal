# Yulgang Crystal
โปรแกรมนี้จัดทำขึ้นมาเพื่อช่วยให้การเปลี่ยนลูกแก้ววิญญาณโดยไม่ต้องมาคอยเปลี่ยนเอง

✅ รองรับลูกแก้วระดับ ล่าง กลาง สูง\
✅ รองรับหลายหน้าจอ\
✅ เปลี่ยนชื่อหน้าจอให้อัตโนมัติ\
✅ สามารถข้ามบางหน้าจอไปได้ ถ้าไม่ต้องการ\
✅ ตั้งค่าหน่วงเวลาได้\
✅ แจ้งเตือนทาง Line Notify สำหรับลูกแก้วหมด หน้าจอหาย\
✅ ส่งสรุปรายงาน\
<br/>
<br/>
![Yulgang Crystal](https://github.com/meawmuay/yulgang-crystal/assets/50597818/f7d7ac44-c847-46ed-812a-108cff0b268c)

## เริ่มต้นใช้งาน

โปรแกรมนี้เขียนด้วยโปรแกรม Visual Studio 2022 และใช้ .NET Framework เวอร์ชั่น 6.0 เป็นอย่างต่ำ
### ดาวน์โหลด
[Yulgang Crystal Version 1.0.4.2](https://github.com/meawmuay/yulgang-crystal/releases/download/v1.0.4.2/Yulgang.Crystal.rar "Yulgang Crystal Latest Version")

### ติดตั้ง
ตัวโปรแกรมไม่มีความจำเป็นต้องติด แต่หากคุณยังไม่ได้ลง .NET Framework เวอร์ชั่น 6.0 หรือมากกว่า ดาวน์โหลดได้จากลิงก์ด้านล่าง

[Microsoft .NET Framework 6.0.24](https://dotnet.microsoft.com/en-us/download/dotnet/thank-you/runtime-desktop-6.0.24-windows-x64-installer "Microsoft .NET Framework 6.0.24 ")

### ตั้งค่า
- สลับจอหน่วงเวลา: เวลาที่ทำงานจอเกมเสร็จสิ้นแล้วให้หน่วงเวลาที่จะไปจอถัดไป เครื่องแรง ๆ สามารถตั้ง 1 วินาทีได้เลย
- หน่วงเวลาทำงานแต่ละรอบ: หลังจากทำงานเสร็จทุกจอแล้ว ให้รอเวลาเพื่อที่จะเริ่มทำงานอีกครั้ง
- คำสั่งเปิดช่องเก็บของ: เลือก TAB หรือ CTRL+E แนะนำ TAB
- ค่าความแม่นยำ ลูกแก้วเดิมๆ: สำหรับลูกแก้วที่ยังไม่ได้ใช้งาน เป็นค่าของการใช้ค้นหาเทียบรูปภาพ หากมันหาไม่เจอแนะนำให้ตั้งต่ำลงเรื่อย ๆ เช่น 0.90 แล้วหาลูกแก้วไม่เจอให้ตั้งเป็น 0.89 ค่ายิ่งต่ำยิ่งเจอง่าย แต่อาจจะไม่ถูกต้อง ยิ่งสูงยิ่งใช่เวลาในการทำงานเยอะขึ้น ค่าแนะนำ 0.90
- ค่าความแม่นยำ ลูกแก้วล่าง: สำหรับลูกแก้วระดับล่างที่กำลังใช้งาน เป็นค่าของการใช้ค้นหาเทียบรูปภาพ ค่าแนะนำ 0.90
- ค่าความแม่นยำ ลูกแก้วกลาง: สำหรับลูกแก้วระดับกลางที่กำลังใช้งาน เป็นค่าของการใช้ค้นหาเทียบรูปภาพ ค่าแนะนำ 0.90
- ค่าความแม่นยำ ลูกแก้วสูง: สำหรับลูกแก้วระดับกลางที่กำลังใช้งาน เป็นค่าของการใช้ค้นหาเทียบรูปภาพ ค่าแนะนำ 0.90
- ตำแหน่งค้นหาลูกแก้ว: ทั้งจอสำหรับเก็บลูกแก้วไว้ที่ สัตว์หรือเป้สำรอง, ช่องเก็บของทั้งหมด สำหรับคนที่ไม่มีช่องอื่น ๆ หรือเปิดเก็บลูกแก้ว EXP, ช่องเก็บของ 1-4 แถวล่าง จะเป็นการนับช่องเก็บของจากแถวด้านล่างขึ้นมา หากคุณเป็นสายฟาร์มแล้วเก็บของ อาจจะได้ลูกแก้วดรอปที่มีอัตราการเก็บวิญญาณที่แย่มาก คุณสามารถเรียงลูกแก้วที่จะใช้งานไว้แถวล่างสุดแล้ว ให้มันค้นหาเฉพาะแถวนั้น ๆ เพื่อนำมาเก็บวิญญาณ ส่วนลูกแก้วที่ดรอปจะอยู่แถวบนสุดไล่ลงมาเรื่อย ๆ
- ลบข้อความการทำงาน: เลือกจำนวนแถว หากข้อความการทำงานถึงแถวที่กำหนดจะลบให้อัตโนมัติเพื่อประหยัด RAM
- ส่งรายงานสรุป: จะส่งสรุปการทำงานไปยัง Line Notify และส่งรูปหน้าจอเกม ขณะนั้นไปทุกจอ
- Line Notify - ขาดการเชื่อมต่อ: แจ้งเตือนจอที่แสดงแจ้งเตือนขาดการเชื่อมต่อ
- Line Notify - กล่องบอทหมดอายุ: แจ้งเตือนจอที่กล่องบอทหายไปจากจอ หากเปิดตัวนี้ต้องอย่ากดปิดกล่องบอททิ้ง
- Line Notify - กล่องบอทหมดอายุ: แจ้งเตือนจอที่หายไป
- Line Notify - ลูกแก้วหมด: แจ้งเตือนเมื่อค้นหาลูกแก้วที่ยังไม่ได้ใข้งาน ไม่พบ
- Line Notify - เมื่อตาย: แจ้งเตือนเมื่อพบตัวละครตาย
- Line Notify - ข้ามการแจ้งเตือนเมื่อบอทวาป: หากตัวละครกำลังวาปไปฝากคลังและซื้อยาอยู่ ระบบจะข้ามการแจ้งเตือนหน้าจอนั้นไป
- Line Notify - ลูกธนูหมด: หากลูกธนูหมด ระบบจะแจ้งเตือน จำเป็นต้องตั้งค่ารายการหน้าจอให้เป็น Arrow ถึงจะทำงาน
- ตั้งชื่อหน้าจอ: ระบบจะเปลี่ยนชื่อหน้าจอให้อัตโนมัติ หากไม่ได้ใช้งานร่วมกับโปรแกรมจำพวกช่วยล็อคอิน เพื่อให้เรารู้ว่ารายการจอไหนเป็นจอไหน

#### Summary
เป็นการนับถอยหลังเพื่อที่จะได้ส่งรายการการสรุปไปที่ Line Notify (ต้องตั้งค่าไลน์ตามด้านล่างก่อน) และต้องเลือกการตั้งค่า ส่งรายงานสรุปมากกว่า 0 นาที
จะมีปุ่มให้กด 4 ปุ่ม
- Reset - เริ่มนับเวลาใหม่
- H +1 - เพิ่มชั่วโมงเข้าไป 1 ชั่วโมงในเวลานับถอยหลัง
- M +1 - เพิ่มนาทีเข้าไป 1 นาทีในเวลานับถอยหลัง
- Test - เมื่อกดปุ่มนี้ จะรอบอททำงานรอบถัดไปแล้วโปรแกรมจะส่งสรุปทันที

### วิธีใช้งาน
1. เปิดไฟล์ Yulgang Crystal.exe เพื่อเข้าใช้งาน
2. จะเจอหน้าต่าง คีย์ของโปรแกรม ให้ Copy Key ของคุณ ส่งให้ที่ https://www.facebook.com/messages/t/100000798267952
3. หลังจากได้ คีย์แล้วให้เอามาใส่ในช่อง Key ใช้งานโปรแกรม แล้วกดเปิดการใช้งาน
4. ตัวโปรแกรมจะมีให้คุณตั้งค่าหน่วงเวลา คุณสามารถเลือกได้
5. หลังจากนั้นให้กด โหลดข้อมูลเกม แล้วจะพบรายการจอเกมขวามือ และปุ่ม S จะเอาไว้แสดงหน้าจอขึ้นมาหากต้องการรู้ว่ารายการไหนคือหน้าจอไหน\
   ![image](https://github.com/meawmuay/yulgang-crystal/assets/50597818/79d11a48-ab93-45f4-b0fb-1745872e81f3)
6. สามารถ ติ๊กถูกออกได้ หากไม่ต้องการให้โปรแกรมทำงานที่จอนั้น
7. หลังจากนั้นให้กดเริ่มทำงาน โปรแกรมจะดึงจอเกมขึ้นมาเองและขยับเมาส์เอง

### การตั้งค่า Line Notify
1. ไปที่ https://notify-bot.line.me/th/ ที่ด้านขวามือให้เลือก เข้าสู่ระบบ\
   ![image](https://github.com/meawmuay/yulgang-crystal/assets/50597818/18026902-ac92-4075-8fc9-7ec91cb361d6)
2. หลังจากนั้น เลือก QR Code Login แล้วใช้มือถือถ่าย QR Code จากแอปไลน์
3. เมื่อเข้าสู่ระบบแล้วให้ไปที่ https://notify-bot.line.me/my/
4. เลื่อนลงมาจะเจอปุ่มที่ชื่อว่า Gererate Token หรือ สร้าง Token\
   ![image](https://github.com/meawmuay/yulgang-crystal/assets/50597818/c75e53b7-3119-4093-8669-a9b8ecd569c1)
5. ให้กรอกชื่อ Token เช่น Yulgang
6. ถัดมาให้ เลือก ไลน์ของเรา จะอยู่อันบนสุด แล้วกดสร้าง ก็จะได้ Token มา
7. ให้เอาไปใส่ที่โปรแกรม ตั้งค่า Token\
   ![image](https://github.com/meawmuay/yulgang-crystal/assets/50597818/5a86dd18-040d-4cdd-b73d-65069e7d81ea)
8. แล้วกดปุ่ม ทดสอบ หลังจากได้รับแจ้งเตือนแล้ว ให้กดปุ่มบันทึก
9. การแจ้งเตือนไลน์จะทำงานต่อหน้าจอ 1 ครั้งเท่านั้นไม่แจ้งเตือนซ้ำจนกว่าจะเริ่มโปรแกรมใหม่ เช่น มีหน้าจอ A ลูกแก้วผลึกหมด ก็จะมีการแจ้งเตือนทางไลน์ แล้วหลังจากนั้นโปรแกรมวนมาเช็คว่าหมดอีก ก็จะไม่แจ้งเตือนอีกแล้วจนกว่าจะเริ่มโปรแกรมใหม่อีกครั้ง




### หมายเหตุ
ทำไมถึงขึ้นตามรายการด้านล่างนี้
- Publisher : Unknown ในขณะที่เปิดโปรแกรม [(ตัวอย่าง)](https://i.imgur.com/peSlQDG.png "(ตัวอย่าง)")
- ตอนดาวน์โหลดเสร็จ บราวเซอร์แจ้งว่า "ไฟล์นี้ไม่ได้มีการดาวน์โหลดเป็นที่แพร่หลายและอาจเป็นอันตราย" หรือ "This file is not commonly downloaded and may be dangerous." [(ตัวอย่าง)](https://i.imgur.com/FkxEtZs.png "(ตัวอย่าง)")

เนื่องมาจาก ตัวโปรแกรมไม่ได้ Publish ด้วย Code Signing Certificate (จำเป็นต้องซื้อและยืนยันตัวตน) และตัวโปรแกรมต้องการสิทธิ์ Administrator เพื่อเข้าถึงฟังก์ชั่นตามด้านล่างนี้จาก Library user32.dll
- FindWindow
- SetWindowTextA
- GetForegroundWindow
- GetWindowText
